(window.webpackJsonp=window.webpackJsonp||[]).push([[118],{648:function(e,t,a){"use strict";a.r(t);var s=a(0),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"migrating-from-ibc-go-v5-to-v6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#migrating-from-ibc-go-v5-to-v6"}},[e._v("#")]),e._v(" Migrating from ibc-go v5 to v6")]),e._v(" "),a("p",[e._v("This document is intended to highlight significant changes which may require more information than presented in the CHANGELOG.\nAny changes that must be done by a user of ibc-go should be documented here.")]),e._v(" "),a("p",[e._v("There are four sections based on the four potential user groups of this document:")]),e._v(" "),a("ul",[a("li",[e._v("Chains")]),e._v(" "),a("li",[e._v("IBC Apps")]),e._v(" "),a("li",[e._v("Relayers")]),e._v(" "),a("li",[e._v("IBC Light Clients")])]),e._v(" "),a("p",[a("strong",[e._v("Note:")]),e._v(" ibc-go supports golang semantic versioning and therefore all imports must be updated to bump the version number on major releases.")]),e._v(" "),a("h2",{attrs:{id:"chains"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#chains"}},[e._v("#")]),e._v(" Chains")]),e._v(" "),a("ul",[a("li",[e._v("No relevant changes were made in this release.")])]),e._v(" "),a("h2",{attrs:{id:"ibc-apps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ibc-apps"}},[e._v("#")]),e._v(" IBC Apps")]),e._v(" "),a("ul",[a("li",[e._v("No relevant changes were made in this release.")])]),e._v(" "),a("h2",{attrs:{id:"relayers"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#relayers"}},[e._v("#")]),e._v(" Relayers")]),e._v(" "),a("ul",[a("li",[e._v("No relevant changes were made in this release.")])]),e._v(" "),a("h2",{attrs:{id:"ibc-light-clients"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ibc-light-clients"}},[e._v("#")]),e._v(" IBC Light Clients")]),e._v(" "),a("h3",{attrs:{id:"clientstate-interface-changes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clientstate-interface-changes"}},[e._v("#")]),e._v(" "),a("code",[e._v("ClientState")]),e._v(" interface changes")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("VerifyUpgradeAndUpdateState")]),e._v(" function has been modified. The client state and consensus state return values have been removed.")]),e._v(" "),a("p",[e._v("Light clients "),a("strong",[e._v("must")]),e._v(" handle all management of client and consensus states including the setting of updated client state and consensus state in the client store.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("CheckHeaderAndUpdateState")]),e._v(" function has been split into 4 new functions:")]),e._v(" "),a("ul",[a("li",[a("p",[a("code",[e._v("VerifyClientMessage")]),e._v(" verifies a "),a("code",[e._v("ClientMessage")]),e._v(". A "),a("code",[e._v("ClientMessage")]),e._v(" could be a "),a("code",[e._v("Header")]),e._v(", "),a("code",[e._v("Misbehaviour")]),e._v(", or batch update. Calls to "),a("code",[e._v("CheckForMisbehaviour")]),e._v(", "),a("code",[e._v("UpdateState")]),e._v(", and "),a("code",[e._v("UpdateStateOnMisbehaviour")]),e._v(" will assume that the content of the "),a("code",[e._v("ClientMessage")]),e._v(" has been verified and can be trusted. An error should be returned if the "),a("code",[e._v("ClientMessage")]),e._v(" fails to verify.")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("CheckForMisbehaviour")]),e._v(" checks for evidence of a misbehaviour in "),a("code",[e._v("Header")]),e._v(" or "),a("code",[e._v("Misbehaviour")]),e._v(" types.")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("UpdateStateOnMisbehaviour")]),e._v(" performs appropriate state changes on a "),a("code",[e._v("ClientState")]),e._v(" given that misbehaviour has been detected and verified.")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("UpdateState")]),e._v(" updates and stores as necessary any associated information for an IBC client, such as the "),a("code",[e._v("ClientState")]),e._v(" and corresponding "),a("code",[e._v("ConsensusState")]),e._v(". An error is returned if "),a("code",[e._v("ClientMessage")]),e._v(" is of type "),a("code",[e._v("Misbehaviour")]),e._v(". Upon successful update, a list containing the updated consensus state height is returned.")])])]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("CheckMisbehaviourAndUpdateState")]),e._v(" function has been removed from "),a("code",[e._v("ClientState")]),e._v(" interface. This functionality is now encapsulated by the usage of "),a("code",[e._v("VerifyClientMessage")]),e._v(", "),a("code",[e._v("CheckForMisbehaviour")]),e._v(", "),a("code",[e._v("UpdateStateOnMisbehaviour")]),e._v(".")]),e._v(" "),a("p",[e._v("The function "),a("code",[e._v("GetTimestampAtHeight")]),e._v(" has been added to the "),a("code",[e._v("ClientState")]),e._v(" interface. It should return the timestamp for a consensus state associated with the provided height.")]),e._v(" "),a("h3",{attrs:{id:"header-and-misbehaviour"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#header-and-misbehaviour"}},[e._v("#")]),e._v(" "),a("code",[e._v("Header")]),e._v(" and "),a("code",[e._v("Misbehaviour")])]),e._v(" "),a("p",[a("code",[e._v("exported.Header")]),e._v(" and "),a("code",[e._v("exported.Misbehaviour")]),e._v(" interface types have been merged and renamed to "),a("code",[e._v("ClientMessage")]),e._v(" interface.")]),e._v(" "),a("p",[a("code",[e._v("GetHeight")]),e._v(" function has been removed from "),a("code",[e._v("exported.Header")]),e._v(" and thus is not included in the "),a("code",[e._v("ClientMessage")]),e._v(" interface")]),e._v(" "),a("h3",{attrs:{id:"consensusstate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#consensusstate"}},[e._v("#")]),e._v(" "),a("code",[e._v("ConsensusState")])]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("GetRoot")]),e._v(" function has been removed from consensus state interface since it was not used by core IBC.")]),e._v(" "),a("h3",{attrs:{id:"light-client-implementations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#light-client-implementations"}},[e._v("#")]),e._v(" Light client implementations")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("09-localhost")]),e._v(" light client implementation has been removed because it is currently non-functional.")]),e._v(" "),a("p",[e._v("An upgrade handler has been added to supply chain developers with the logic needed to prune the ibc client store and successfully complete the removal of "),a("code",[e._v("09-localhost")]),e._v(".\nAdd the following to the application upgrade handler in "),a("code",[e._v("app/app.go")]),e._v(", calling "),a("code",[e._v("MigrateToV6")]),e._v(" to perform store migration logic.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aW1wb3J0ICgKICAgIC8vIC4uLgogICAgaWJjdjYgJnF1b3Q7Z2l0aHViLmNvbS9jb3Ntb3MvaWJjLWdvL3Y2L21vZHVsZXMvY29yZS9taWdyYXRpb25zL3Y2JnF1b3Q7CikKCi8vIC4uLgoKYXBwLlVwZ3JhZGVLZWVwZXIuU2V0VXBncmFkZUhhbmRsZXIoCiAgICB1cGdyYWRlTmFtZSwKICAgIGZ1bmMoY3R4IHNkay5Db250ZXh0LCBfIHVwZ3JhZGV0eXBlcy5QbGFuLCBfIG1vZHVsZS5WZXJzaW9uTWFwKSAobW9kdWxlLlZlcnNpb25NYXAsIGVycm9yKSB7CiAgICAgICAgLy8gcHJ1bmUgdGhlIDA5LWxvY2FsaG9zdCBjbGllbnQgZnJvbSB0aGUgaWJjIGNsaWVudCBzdG9yZQogICAgICAgIGliY3Y2Lk1pZ3JhdGVUb1Y2KGN0eCwgYXBwLklCQ0tlZXBlci5DbGllbnRLZWVwZXIpCgogICAgICAgIHJldHVybiBhcHAubW0uUnVuTWlncmF0aW9ucyhjdHgsIGFwcC5jb25maWd1cmF0b3IsIGZyb21WTSkKICAgIH0sCikK"}}),e._v(" "),a("p",[e._v("Please note the above upgrade handler is optional and should only be run if chains have an existing "),a("code",[e._v("09-localhost")]),e._v(" client stored in state.\nA simple query can be performed to check for a "),a("code",[e._v("09-localhost")]),e._v(" client on chain.")]),e._v(" "),a("p",[e._v("For example:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"",base64:"c2ltZCBxdWVyeSBpYmMgY2xpZW50IHN0YXRlcyB8IGdyZXAgMDktbG9jYWxob3N0Cg=="}}),e._v(" "),a("h3",{attrs:{id:"client-keeper"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#client-keeper"}},[e._v("#")]),e._v(" Client Keeper")]),e._v(" "),a("p",[e._v("Keeper function "),a("code",[e._v("CheckMisbehaviourAndUpdateState")]),e._v(" has been removed since function "),a("code",[e._v("UpdateClient")]),e._v(" can now handle updating "),a("code",[e._v("ClientState")]),e._v(" on "),a("code",[e._v("ClientMessage")]),e._v(" type which can be any "),a("code",[e._v("Misbehaviour")]),e._v(" implementations.")]),e._v(" "),a("h3",{attrs:{id:"sdk-message"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sdk-message"}},[e._v("#")]),e._v(" SDK Message")]),e._v(" "),a("p",[a("code",[e._v("MsgSubmitMisbehaviour")]),e._v(" is deprecated since "),a("code",[e._v("MsgUpdateClient")]),e._v(" can now submit a "),a("code",[e._v("ClientMessage")]),e._v(" type which can be any "),a("code",[e._v("Misbehaviour")]),e._v(" implementations.")]),e._v(" "),a("p",[e._v("The field "),a("code",[e._v("header")]),e._v(" in "),a("code",[e._v("MsgUpdateClient")]),e._v(" has been renamed to "),a("code",[e._v("client_message")]),e._v(".")])],1)}),[],!1,null,null,null);t.default=n.exports}}]);